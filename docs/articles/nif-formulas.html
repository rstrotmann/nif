<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>NIF data definition using formulae • nif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="NIF data definition using formulae">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.57.4.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/nif-tutorial.html">Creating NIF files from SDTM data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-dose-example.html">Example: Multiple-dose study</a></li>
    <li><a class="dropdown-item" href="../articles/nif-imputations.html">Imputations and assumptions</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-study-example.html">Multiple studies in one NIF</a></li>
    <li><a class="dropdown-item" href="../articles/nif-formulas.html">NIF data definition using formulae</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstrotmann/nif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NIF data definition using formulae</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstrotmann/nif/blob/HEAD/vignettes/nif-formulas.Rmd" class="external-link"><code>vignettes/nif-formulas.Rmd</code></a></small>
      <div class="d-none name"><code>nif-formulas.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstrotmann/nif" class="external-link">nif</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/nif_option.html">nif_option</a></span><span class="op">(</span>silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">INTRODUCTION<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The ‘nif’ package is mean to facilitate the creation of NONMEM Input
Format (NIF)- compliant data files for the analysis of longitudinal
(time-varying) clinical data. For a gentle introduction, see
<code><a href="../articles/nif-tutorial.html">vignette("nif-tutorial")</a></code>.</p>
<p>The overarching concept of the ‘nif’ package is to gradually build a
data set, sequentially adding administrations, observations, baseline
data and covariates. A typical workflow may look like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sdtm</span> <span class="op">&lt;-</span> <span class="va">examplinib_sad</span></span>
<span></span>
<span><span class="va">nif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nif.html">nif</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_administration.html">add_administration</a></span><span class="op">(</span><span class="va">sdtm</span>, <span class="st">"EXAMPLINIB"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_observation.html">add_observation</a></span><span class="op">(</span><span class="va">sdtm</span>, <span class="st">"pc"</span>, <span class="st">"RS2023"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_observation.html">add_observation</a></span><span class="op">(</span><span class="va">sdtm</span>, <span class="st">"pc"</span>, <span class="st">"RS2023487A"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_baseline.html">add_baseline</a></span><span class="op">(</span><span class="va">sdtm</span>, <span class="st">"lb"</span>, <span class="st">"CREAT"</span><span class="op">)</span></span></code></pre></div>
<p>The only time-varying data in this NIF data set are now the two
pharmacokinetic analytes, ‘RS2023’ and ‘RS2023487A’. Real clinical data
typically include many time-varying observations, and for PK/PD
analyses, and we might be interested in adding further observation
events to the nif data set.</p>
<p>We can get an overview on all observation events included in the SDTM
data like so:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testcd.html">testcd</a></span><span class="op">(</span><span class="va">sdtm</span><span class="op">)</span></span>
<span><span class="co">#&gt;    DOMAIN     TESTCD</span></span>
<span><span class="co">#&gt; 1      VS     HEIGHT</span></span>
<span><span class="co">#&gt; 2      VS     WEIGHT</span></span>
<span><span class="co">#&gt; 3      PC     RS2023</span></span>
<span><span class="co">#&gt; 4      PC RS2023487A</span></span>
<span><span class="co">#&gt; 5      LB      CREAT</span></span>
<span><span class="co">#&gt; 6      PP     AUCLST</span></span>
<span><span class="co">#&gt; 7      PP       CMAX</span></span>
<span><span class="co">#&gt; 8      PP       TMAX</span></span>
<span><span class="co">#&gt; 9      PP       TLST</span></span>
<span><span class="co">#&gt; 10     PP       LAMZ</span></span>
<span><span class="co">#&gt; 11     PP      R2ADJ</span></span>
<span><span class="co">#&gt; 12     PP    LAMZNPT</span></span>
<span><span class="co">#&gt; 13     PP     LAMZHL</span></span>
<span><span class="co">#&gt; 14     PP     AUCIFP</span></span></code></pre></div>
<p>Likewise, we can get an overview on the treatments included in the
SDTM data with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">sdtm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "EXAMPLINIB"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="nif-formulae">NIF FORMULAE<a class="anchor" aria-label="anchor" href="#nif-formulae"></a>
</h2>
<p>While the code for building a NIF data set that is shown above
follows a clear logic, sequentially addition data components, it may be
sometimes preferable to use more compact code. To this end, the ‘nif’
package allows the definition of the data sources for an analysis data
set using <em>formulae</em>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nif_auto.html">nif_auto</a></span><span class="op">(</span><span class="va">sdtm</span>, <span class="va">RS2023</span> <span class="op">+</span> <span class="va">RS2023487A</span> <span class="op">~</span> <span class="va">EXAMPLINIB</span><span class="op">)</span></span></code></pre></div>
<p>The formulae provided as arguments to <code><a href="../reference/nif_auto.html">nif_auto()</a></code> follow
a consistent notation. Observations are on the left hand side, and
treatments (drug administrations) are on the right hand side of the
formula:</p>
<p><code>analyte1 + analyte2 ~ treatment</code></p>
<p>The number of analytes on the left hand side is not limited, but the
right hand side of the formula must specify a single administration that
the observations relate to.</p>
<p>We have specified two pharmacokinetic observations (‘RS2023’ and
‘RS2023487A’). However observations may be of any kind, e.g., from the
clinical lab (LB), vital sign (VS), ECG (EG), or any other SDTM
domain.</p>
<p>Note that the above code includes only one formula, but if there are
multiple drugs administered with associated observations, multiple
formulae can be provided as arguments to <code><a href="../reference/nif_auto.html">nif_auto()</a></code>.</p>
<p>Inspecting the resulting nif object, we can see that
<code><a href="../reference/nif_auto.html">nif_auto()</a></code> has also added baseline serum creatinine data
and derived the baseline creatinine clearance and renal function
category from it:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nif</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   REF ID    STUDYID           USUBJID AGE SEX  RACE HEIGHT WEIGHT     BMI</span></span>
<span><span class="co">#&gt; 1   1  1 2023000001 20230000011010001  43   0 WHITE  187.4     77 21.9256</span></span>
<span><span class="co">#&gt; 2   2  1 2023000001 20230000011010001  43   0 WHITE  187.4     77 21.9256</span></span>
<span><span class="co">#&gt; 3   3  1 2023000001 20230000011010001  43   0 WHITE  187.4     77 21.9256</span></span>
<span><span class="co">#&gt;                   DTC TIME NTIME TAFD TAD EVID AMT    ANALYTE CMT PARENT TRTDY</span></span>
<span><span class="co">#&gt; 1 2000-12-31 10:18:00    0     0    0   0    1   5     RS2023   1 RS2023     1</span></span>
<span><span class="co">#&gt; 2 2000-12-31 10:18:00    0     0    0   0    0   0     RS2023   2 RS2023     1</span></span>
<span><span class="co">#&gt; 3 2000-12-31 10:18:00    0     0    0   0    0   0 RS2023487A   3 RS2023     1</span></span>
<span><span class="co">#&gt;   METABOLITE DOSE MDV ACTARMCD IMPUTATION DV BL_CREAT  BL_CRCL BL_RENAL</span></span>
<span><span class="co">#&gt; 1      FALSE    5   1       C1            NA  67.4825 115.5074   normal</span></span>
<span><span class="co">#&gt; 2      FALSE    5   0       C1             0  67.4825 115.5074   normal</span></span>
<span><span class="co">#&gt; 3       TRUE    5   0       C1             0  67.4825 115.5074   normal</span></span></code></pre></div>
<p><code><a href="../reference/nif_auto.html">nif_auto()</a></code> will further attempt to infer the baseline
hepatic function category as per the NCI ODWG classification from
baseline bilirubin and AST data. In this example SDTM data set, these
parameters are not part of the LB domain, though.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rainer Strotmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
