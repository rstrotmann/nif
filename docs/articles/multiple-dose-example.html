<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>NIF data for a multiple-dose study • nif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="NIF data for a multiple-dose study">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.50.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/multiple-dose-example.html">NIF data for a multiple-dose study</a></li>
    <li><a class="dropdown-item" href="../articles/nif-imputations.html">Imputations and assumptions</a></li>
    <li><a class="dropdown-item" href="../articles/nif-vignette.html">Creating NIF files from SDTM data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstrotmann/nif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NIF data for a multiple-dose study</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstrotmann/nif/blob/HEAD/vignettes/multiple-dose-example.Rmd" class="external-link"><code>vignettes/multiple-dose-example.Rmd</code></a></small>
      <div class="d-none name"><code>multiple-dose-example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstrotmann/nif" class="external-link">nif</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">OVERVIEW<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette walks through the creation of a NONMEM input file (NIF)
data set for a prototypical multiple dose study (study ‘RS2023-0022’),
followed by some basic exploratory analyses.</p>
<p>The (fictional) raw study data are included as part of the NIF
package as <code>examplinib_poc</code>. Custom SDTM data can be loaded
using <code><a href="../reference/read_sdtm.html">read_sdtm()</a></code>.</p>
<div class="section level3">
<h3 id="study-design">Study design<a class="anchor" aria-label="anchor" href="#study-design"></a>
</h3>
<p>Study ‘RS2023-0022’ is a single-arm study in which subjects received
multiple doses of ‘examplinib’ (substance code ‘RS2023’). The treatment
duration is different across subjects. PK sampling was on Days 1 and 8
of the treatment period. The PK sampling schedule was rich in the
initial subset of subjects and sparse in the others.</p>
</div>
<div class="section level3">
<h3 id="study-sdtm-data">Study SDTM data<a class="anchor" aria-label="anchor" href="#study-sdtm-data"></a>
</h3>
<p>The package provides the ‘sdtm’ class as a wrapper to keep all SDTM
domain tables of a clinical study together in one object. The
<code>examplinib_poc</code> sdtm object contains the DM, EX, PC and VS
domains. Let’s print the <code>examplinib_poc</code> sdtm object for a
high-level overview:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplinib_poc</span></span>
<span><span class="co">#&gt; -------- SDTM data set summary -------- </span></span>
<span><span class="co">#&gt; Study 2023000022 with 80 subjects providing PC data.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Subjects per domain:</span></span>
<span><span class="co">#&gt;  DOMAIN   N     </span></span>
<span><span class="co">#&gt;  dm       103   </span></span>
<span><span class="co">#&gt;  vs       103   </span></span>
<span><span class="co">#&gt;  ex       80    </span></span>
<span><span class="co">#&gt;  pc       80    </span></span>
<span><span class="co">#&gt;  lb       103   </span></span>
<span><span class="co">#&gt;  pp       13    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Arms (DM):</span></span>
<span><span class="co">#&gt;  ACTARMCD    ACTARM                 </span></span>
<span><span class="co">#&gt;  TREATMENT   Single Arm Treatment   </span></span>
<span><span class="co">#&gt;  SCRNFAIL    Screen Faillure        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatments (EX):</span></span>
<span><span class="co">#&gt;  EXAMPLINIB </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PK sample specimens (PC):</span></span>
<span><span class="co">#&gt;  (none) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PK analytes (PC):</span></span>
<span><span class="co">#&gt;  PCTEST       PCTESTCD     </span></span>
<span><span class="co">#&gt;  RS2023       RS2023       </span></span>
<span><span class="co">#&gt;  RS2023487A   RS2023487A    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatment-to-analyte mappings:</span></span>
<span><span class="co">#&gt;  EXTRT        PCTESTCD   ANALYTE   </span></span>
<span><span class="co">#&gt;  EXAMPLINIB   RS2023     RS2023     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parent-to-metabolite mappings:</span></span>
<span><span class="co">#&gt;  PCTESTCD_parent   PCTESTCD_metab   </span></span>
<span><span class="co">#&gt;  RS2023            RS2023487A</span></span></code></pre></div>
<p>Note that in the EX domain, the administered drug is given as
‘EXAMPLINIB’ while in PC, the corresponding analyte is ‘RS2023’. The
other analyte, ‘RS2023487A’ is a metabolite.</p>
<p>To clearly specify these correlations, the SDTM object includes the
fields <code>examplinib_poc$analyte_mapping</code> and
<code>examplinib_poc$metabolite_mapping</code>. Both can be defined when
the SDTM data set is created. See the documentation to
<code><a href="../reference/add_analyte_mapping.html">add_analyte_mapping()</a></code> and
<code><a href="../reference/add_metabolite_mapping.html">add_metabolite_mapping()</a></code> for details.</p>
<p>For this SDTM object, both mappings have been added already.</p>
</div>
</div>
<div class="section level2">
<h2 id="creating-a-nif-data-set">CREATING A NIF DATA SET<a class="anchor" aria-label="anchor" href="#creating-a-nif-data-set"></a>
</h2>
<p>To enable more complex analyses and analyses in the time domain, the
data from different SDTM domains must be integrated into a single data
frame in long table format. For modeling analyses, a common format
specification is the NONMEM input file (NIF) format that is at the core
of the <code>nif</code> package.</p>
<p><code>nif</code> objects are minimally composed from administrations
and observations. Following the NONMEM nomenclature, the former have an
‘EVID’ of 1, the latter an ‘EVID’ of 0. In the following code, an empty
nif object is created using <code><a href="../reference/new_nif.html">new_nif()</a></code>, to which
‘EXAMPLINIB’ administrations are then added using
<code><a href="../reference/add_administration.html">add_administration()</a></code>. Note that the analyte field for this
drug is set to ‘RS2023’. In a second step, pharmacokinetic
concentrations for ‘RS2023’ are added from the ‘PC’ SDTM domain. To
match the administration, the analyte field is again ‘RS2023’. The
compartment is automatically set to 2. Both functions have as their
first arguemt the ‘sdtm’ object:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sdtm</span> <span class="op">&lt;-</span> <span class="va">examplinib_poc</span></span>
<span></span>
<span><span class="va">nif_poc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_nif.html">new_nif</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_administration.html">add_administration</a></span><span class="op">(</span><span class="va">sdtm</span>, extrt <span class="op">=</span> <span class="st">"EXAMPLINIB"</span>, analyte <span class="op">=</span> <span class="st">"RS2023"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_observation.html">add_observation</a></span><span class="op">(</span><span class="va">sdtm</span>, domain <span class="op">=</span> <span class="st">"pc"</span>, testcd <span class="op">=</span> <span class="st">"RS2023"</span>, analyte <span class="op">=</span> <span class="st">"RS2023"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compartment for RS2023 was not specified and has been set to 2</span></span></code></pre></div>
<p>The ‘LB’ domain within this sdtm object contains baseline creatinine
data which can be used to calculate the individual baseline creatinine
clearance as an estimate for glomerular filtration rate (eGFR). Baseline
covariates are created using ’add_baseline()`.</p>
<p>In the first step, baseline creatinine is added from ‘LB’, and then
the creatinine clearance is calculated using further demographic
parameters (sex, age, race, weight). The standard method is
Cockcroft-Gault but other methods can be specified:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op">&lt;-</span> <span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_baseline.html">add_baseline</a></span><span class="op">(</span><span class="va">sdtm</span>, domain <span class="op">=</span> <span class="st">"lb"</span>, testcd <span class="op">=</span> <span class="st">"CREAT"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_bl_crcl.html">add_bl_crcl</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In fact, the nif data set that we have just created, including the
baseline creatinine clearance data, is already included in the
<code>nif</code> package as <code>examplinib_poc_nif</code>.</p>
<p>In case NIF data sets have been generated externally, they can be
converted into nif objects using <code><a href="../reference/new_nif.html">new_nif()</a></code>, see the
documentation to this function for details.</p>
<p>Note that a nif object is essentially a wrapper around a data frame
with the set of variables expected by NONMEM or other population
analysis tools. This becomes visible when the object is converted into a
data frame:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#    REF ID    STUDYID           USUBJID AGE SEX  RACE HEIGHT WEIGHT      BMI</span></span>
<span><span class="co">#  1   1  1 2023000022 20230000221070001  73   0 WHITE  177.8   83.3 26.35005</span></span>
<span><span class="co">#  2   2  1 2023000022 20230000221070001  73   0 WHITE  177.8   83.3 26.35005</span></span>
<span><span class="co">#  3   3  1 2023000022 20230000221070001  73   0 WHITE  177.8   83.3 26.35005</span></span>
<span><span class="co">#  4   4  1 2023000022 20230000221070001  73   0 WHITE  177.8   83.3 26.35005</span></span>
<span><span class="co">#  5   5  1 2023000022 20230000221070001  73   0 WHITE  177.8   83.3 26.35005</span></span>
<span><span class="co">#  6   6  1 2023000022 20230000221070001  73   0 WHITE  177.8   83.3 26.35005</span></span>
<span><span class="co">#                    DTC  TIME NTIME  TAFD   TAD PCELTM EVID AMT ANALYTE CMT</span></span>
<span><span class="co">#  1 2000-12-29 09:07:00 0.000   0.0 0.000 0.000   &lt;NA&gt;    1 500  RS2023   1</span></span>
<span><span class="co">#  2 2000-12-29 09:07:00 0.000   0.0 0.000 0.000   PT0H    0   0  RS2023   2</span></span>
<span><span class="co">#  3 2000-12-29 10:17:00 1.167   0.5 1.167 1.167 PT0.5H    0   0  RS2023   2</span></span>
<span><span class="co">#  4 2000-12-29 10:46:00 1.650   1.0 1.650 1.650   PT1H    0   0  RS2023   2</span></span>
<span><span class="co">#  5 2000-12-29 11:17:00 2.167   1.5 2.167 2.167 PT1.5H    0   0  RS2023   2</span></span>
<span><span class="co">#  6 2000-12-29 11:47:00 2.667   2.0 2.667 2.667   PT2H    0   0  RS2023   2</span></span>
<span><span class="co">#    PARENT TRTDY METABOLITE DOSE        DV MDV  ACTARMCD</span></span>
<span><span class="co">#  1 RS2023     1      FALSE  500        NA   1 TREATMENT</span></span>
<span><span class="co">#  2 RS2023     1      FALSE  500    0.0000   0 TREATMENT</span></span>
<span><span class="co">#  3 RS2023     1      FALSE  500  660.6079   0 TREATMENT</span></span>
<span><span class="co">#  4 RS2023     1      FALSE  500 1361.6798   0 TREATMENT</span></span>
<span><span class="co">#  5 RS2023     1      FALSE  500 2139.0566   0 TREATMENT</span></span>
<span><span class="co">#  6 RS2023     1      FALSE  500 2819.4098   0 TREATMENT</span></span>
<span><span class="co">#                          IMPUTATION BL_CREAT  BL_CRCL</span></span>
<span><span class="co">#  1 admin time imputed from PCRFTDTC  77.8169 74.84876</span></span>
<span><span class="co">#  2                                   77.8169 74.84876</span></span>
<span><span class="co">#  3                                   77.8169 74.84876</span></span>
<span><span class="co">#  4                                   77.8169 74.84876</span></span>
<span><span class="co">#  5                                   77.8169 74.84876</span></span>
<span><span class="co">#  6                                   77.8169 74.84876</span></span></code></pre></div>
<p>When the NIF object itself is printed, a summary of the data is shown
instead:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span></span>
<span><span class="co">#  ----- NONMEM input file (NIF) object -----</span></span>
<span><span class="co">#  RS2023 data from one study</span></span>
<span><span class="co">#  672 observations from 80 subjects</span></span>
<span><span class="co">#  Males: 46, females: 34 (42.5%)</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Columns:</span></span>
<span><span class="co">#  REF, ID, STUDYID, USUBJID, AGE, SEX, RACE, HEIGHT, WEIGHT, BMI, DTC, TIME, NTIME, TAFD, TAD, PCELTM, EVID, AMT, ANALYTE, CMT, PARENT, TRTDY, METABOLITE, DOSE, DV, MDV, ACTARMCD, IMPUTATION, BL_CREAT, BL_CRCL </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  NIF data (selected columns):</span></span>
<span><span class="co">#  ID   NTIME   TIME    TAD     ANALYTE   EVID   CMT   AMT   DOSE   DV         </span></span>
<span><span class="co">#  1    0       0       0       RS2023    1      1     500   500    NA         </span></span>
<span><span class="co">#  1    0       0       0       RS2023    0      2     0     500    0          </span></span>
<span><span class="co">#  1    0.5     1.167   1.167   RS2023    0      2     0     500    660.608    </span></span>
<span><span class="co">#  1    1       1.65    1.65    RS2023    0      2     0     500    1361.68    </span></span>
<span><span class="co">#  1    1.5     2.167   2.167   RS2023    0      2     0     500    2139.057   </span></span>
<span><span class="co">#  1    2       2.667   2.667   RS2023    0      2     0     500    2819.41    </span></span>
<span><span class="co">#  1    3       3.633   3.633   RS2023    0      2     0     500    2125.782   </span></span>
<span><span class="co">#  1    4       4.533   4.533   RS2023    0      2     0     500    1986.097   </span></span>
<span><span class="co">#  1    6       6.733   6.733   RS2023    0      2     0     500    842.133    </span></span>
<span><span class="co">#  1    8       8.567   8.567   RS2023    0      2     0     500    526.231    </span></span>
<span><span class="co">#  6972 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploration">EXPLORATION<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<div class="section level3">
<h3 id="demographics">Demographics<a class="anchor" aria-label="anchor" href="#demographics"></a>
</h3>
<p>For an initial overview on the distribution of baseline parameters,
the administered drugs, analytes, observations, etc., NIF objects can be
inspected with the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function. Note that since we
have added baseline eGFR to the data set, the output also summarizes the
number of patients with normal renal function or impaired renal
function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span></span>
<span><span class="co">#  ----- NONMEM input file (NIF) object summary -----</span></span>
<span><span class="co">#  Data from 80 subjects across one study:</span></span>
<span><span class="co">#   STUDYID      N    </span></span>
<span><span class="co">#   2023000022   80   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Males: 46, females: 34 (42.5%)</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Renal impairment class:</span></span>
<span><span class="co">#   CLASS      N    </span></span>
<span><span class="co">#   mild       35   </span></span>
<span><span class="co">#   moderate   13   </span></span>
<span><span class="co">#   normal     32   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Administered drugs:</span></span>
<span><span class="co">#   RS2023</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Administered drugs:</span></span>
<span><span class="co">#   RS2023</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Analytes:</span></span>
<span><span class="co">#   RS2023</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Subjects per dose levels:</span></span>
<span><span class="co">#   RS2023   N    </span></span>
<span><span class="co">#   500      80   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  672 observations:</span></span>
<span><span class="co">#   CMT   ANALYTE   N     </span></span>
<span><span class="co">#   2     RS2023    672   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Subjects with dose reductions</span></span>
<span><span class="co">#   RS2023   </span></span>
<span><span class="co">#   27       </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Treatment duration overview:</span></span>
<span><span class="co">#   PARENT   min   max   mean   median   </span></span>
<span><span class="co">#   RS2023   53    98    78.9   81</span></span></code></pre></div>
<p>For a visual overview of the NIF data set <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can be
applied to the summary:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-1.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-2.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-3.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-4.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-5.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-6.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-7.png" width="288"></p>
</div>
<div class="section level3">
<h3 id="exposure">Exposure<a class="anchor" aria-label="anchor" href="#exposure"></a>
</h3>
<p>In this study, all 80 subject received the same dose level:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dose_levels.html">dose_levels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Dose levels"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Dose levels</caption>
<thead><tr class="header">
<th align="right">RS2023</th>
<th align="right">N</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">500</td>
<td align="right">80</td>
</tr></tbody>
</table>
<p>However, there were subjects with dose reductions, as we can see when
filtering the nif data set for EVID == 1 (administrations) and
summarizing the administered dose:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">DOSE</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">250</td>
<td align="right">1198</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">5112</td>
</tr>
</tbody>
</table>
<p>To identify the subjects with dose reductions:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dose_red_sbs.html">dose_red_sbs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#   [1]  1  3 14 28 29 30 35 38 47 48 50 52 54 56 57 58 59 62 64 67 68 70 71 72 74</span></span>
<span><span class="co">#  [26] 77 79</span></span></code></pre></div>
<p>Let’s have a plot of the doses over time in these subjects:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/dose_red_sbs.html">dose_red_sbs</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">DOSE</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<p>We see that dose reductions happended at different times during
treatment. Another way of visualizing this is per the
<code><a href="../reference/mean_dose_plot.html">mean_dose_plot()</a></code> function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mean_dose_plot.html">mean_dose_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-13-1.png" width="480"></p>
<p>The upper panel shows the mean dose over time, and we can see that
after ~Day 13, the mean dose across all treated subjects drops due to
dose reductions in some subjects. To put this into context, the lower
panel shows the number of subjects on treatment over time, and we see
that most subjects had treatment durations of around 30 days. Note the
fluctuations that indicate single missed doses in individual
subjects!</p>
</div>
<div class="section level3">
<h3 id="pk-sampling">PK sampling<a class="anchor" aria-label="anchor" href="#pk-sampling"></a>
</h3>
<p>The PK sampling time points in this study were:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">NTIME</span>, <span class="va">ANALYTE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"ANALYTE"</span>, values_from <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Observations by time point and analyte"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Observations by time point and analyte</caption>
<thead><tr class="header">
<th align="right">NTIME</th>
<th align="right">RS2023</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">1.5</td>
<td align="right">160</td>
</tr>
<tr class="odd">
<td align="right">2.0</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">3.0</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="right">6.0</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">8.0</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">10.0</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">12.0</td>
<td align="right">24</td>
</tr>
</tbody>
</table>
<p>From the different numbers of samplings per nominal time point, we
see that only a subset of subjects had a rich sampling scheme. Let’s
identify those:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, max_time <span class="op">=</span> <span class="fl">24</span>, n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#   [1]  1  2  3  4  5  6  7  8  9 10 11 12</span></span></code></pre></div>
<p>In this code, the function <code><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs()</a></code> receives
as input the analyte of interest, the time interval across which the
number of sanmples is evaluated, and the minimum number of samples to
qualify the schedule as rich.</p>
</div>
<div class="section level3">
<h3 id="plasma-concentration-data">Plasma concentration data<a class="anchor" aria-label="anchor" href="#plasma-concentration-data"></a>
</h3>
<p>Let’s plot the individual and mean plasma concentration profiles on
Day 1 for the parent, RS2023, and the metabolite, RS2023487A:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span><span class="va">nif_poc</span>, analyte <span class="op">=</span> <span class="st">"RS2023"</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">500</span>, points <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Rich sampling subjects"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-16-1.png" width="480"></p>
<p>For single and mutliple dose administrations separately:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/index_rich_sampling_intervals.html">index_rich_sampling_intervals</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RICH_N</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, mean <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Single-dose PK"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-17-1.png" width="480"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RICH_N</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, title <span class="op">=</span> <span class="st">"Multiple-dose PK"</span>, time <span class="op">=</span> <span class="st">"NTIME"</span>, mean <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-17-2.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="non-compartmental-analysis">Non-compartmental analysis<a class="anchor" aria-label="anchor" href="#non-compartmental-analysis"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nca</span> <span class="op">&lt;-</span> <span class="va">examplinib_poc_nif</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/index_rich_sampling_intervals.html">index_rich_sampling_intervals</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, min_n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/nca.html">nca</a></span><span class="op">(</span><span class="st">"RS2023"</span>, group <span class="op">=</span> <span class="st">"RICH_N"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/nca_summary_table.html">nca_summary_table</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"RICH_N"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="5%">
<col width="4%">
<col width="15%">
<col width="15%">
<col width="15%">
<col width="11%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="left">RICH_N</th>
<th align="right">DOSE</th>
<th align="right">n</th>
<th align="left">aucinf.obs</th>
<th align="left">auclast</th>
<th align="left">cmax</th>
<th align="left">half.life</th>
<th align="left">tmax</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">250</td>
<td align="right">2</td>
<td align="left">10189.8 (35)</td>
<td align="left">9963.92 (33)</td>
<td align="left">2920.08 (5)</td>
<td align="left">2.05 (12)</td>
<td align="left">2.67 (2.67; 2.67)</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">500</td>
<td align="right">12</td>
<td align="left">9433.11 (29)</td>
<td align="left">9285.59 (28)</td>
<td align="left">2882.56 (19)</td>
<td align="left">2.05 (26)</td>
<td align="left">2.61 (1.98; 2.95)</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">250</td>
<td align="right">2</td>
<td align="left">10841.58 (41)</td>
<td align="left">10590.38 (39)</td>
<td align="left">2638.01 (7)</td>
<td align="left">1.83 (27)</td>
<td align="left">2.65 (2.65; 2.65)</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">500</td>
<td align="right">12</td>
<td align="left">9475.41 (28)</td>
<td align="left">9283.83 (27)</td>
<td align="left">2667.08 (15)</td>
<td align="left">1.87 (30)</td>
<td align="left">2.5 (1.75; 3.58)</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="right">250</td>
<td align="right">9</td>
<td align="left">NaN (NA)</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NaN (NA)</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">250</td>
<td align="right">59</td>
<td align="left">NA</td>
<td align="left">4887.73 (134)</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="right">250</td>
<td align="right">216</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2688.3 (19)</td>
<td align="left">NA</td>
<td align="left">97.96 (1.67; 218.45)</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">500</td>
<td align="right">31</td>
<td align="left">NaN (NA)</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NaN (NA)</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="right">500</td>
<td align="right">166</td>
<td align="left">NA</td>
<td align="left">4347.04 (178)</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">500</td>
<td align="right">605</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">2139.28 (157)</td>
<td align="left">NA</td>
<td align="left">97.7 (1.63; 218.45)</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rainer Strotmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
