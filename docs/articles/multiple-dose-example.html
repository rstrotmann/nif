<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nif">
<title>Example: NIF data for a multiple-dose study • nif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example: NIF data for a multiple-dose study">
<meta property="og:description" content="nif">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.41.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/multiple-dose-example.html">Example: NIF data for a multiple-dose study</a>
    <a class="dropdown-item" href="../articles/nif-imputations.html">Imputations and assumptions used by make_nif()</a>
    <a class="dropdown-item" href="../articles/nif-vignette.html">Creating NIF files from SDTM data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example: NIF data for a multiple-dose study</h1>
            
      
      
      <div class="d-none name"><code>multiple-dose-example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">nif</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">OVERVIEW<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette walks through the creation of a NIF data set for a
prototypical multiple dose study (study ‘RS2023-0022’), as well as some
basic exploratory analyses.</p>
<p>The (entirely fictional) raw study data are provided in SDTM format
as part of the NIF package as ‘examplinib_poc’. Actual SDTM data can be
loaded using <code><a href="../reference/read_sdtm_sas.html">read_sdtm_sas()</a></code> of
<code><a href="../reference/read_sdtm_xpt.html">read_sdtm_xpt()</a></code> - for further information see the
documentation for the respective functions.</p>
<div class="section level3">
<h3 id="study-design">Study design<a class="anchor" aria-label="anchor" href="#study-design"></a>
</h3>
<p>Study ‘RS2023-0022’ is a single-arm study in which subjects received
multiple doses of ‘examplinib’ (substance code ‘RS2023’). The treatment
duration is different across subjects. PK sampling was on Days 1 and 8
of the treatment period. The PK sampling schedule was rich in the
initial subset of subjects and sparse in the others.</p>
</div>
<div class="section level3">
<h3 id="study-sdtm-data">Study SDTM data<a class="anchor" aria-label="anchor" href="#study-sdtm-data"></a>
</h3>
<p>SDTM data objects as defined in the NIF package are aggregates of the
original SDTM domains together with some metadata. Let’s print the
‘examplinib_poc’ SDTM object for a high-level overview on the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplinib_poc</span></span>
<span><span class="co">#&gt; SDTM data set summary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Study 2023000022 with 80 subjects providing PC data.</span></span>
<span><span class="co">#&gt; SDTM domains: dm, vs, ex, pc, lb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Arms:</span></span>
<span><span class="co">#&gt;   ACTARM               ACTARMCD </span></span>
<span><span class="co">#&gt; 1 Screen Faillure      SCRNFAIL </span></span>
<span><span class="co">#&gt; 2 Single Arm Treatment TREATMENT</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatments:</span></span>
<span><span class="co">#&gt;   EXTRT     </span></span>
<span><span class="co">#&gt; 1 EXAMPLINIB</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Specimens:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analytes:</span></span>
<span><span class="co">#&gt;   PCTEST     PCTESTCD  </span></span>
<span><span class="co">#&gt; 1 RS2023     RS2023    </span></span>
<span><span class="co">#&gt; 2 RS2023487A RS2023487A</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatment-to-analyte mappings:</span></span>
<span><span class="co">#&gt;   EXTRT      PCTESTCD</span></span>
<span><span class="co">#&gt; 1 EXAMPLINIB RS2023  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parent-to-metabolite mappings:</span></span>
<span><span class="co">#&gt;   PCTESTCD_parent PCTESTCD_metab</span></span>
<span><span class="co">#&gt; 1 RS2023          RS2023487A    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Time mappings:</span></span>
<span><span class="co">#&gt; none</span></span></code></pre></div>
<p>Note that in the EX domain, the administered drug is given as
‘EXAMPLINIB’ while in PC, the corresponding analyte is ‘RS2023’. The
other analyte, ‘RS2023487A’ is a metabolite.</p>
<p>To clearly specify these correlations, the SDTM object contains the
fields <code>examplinib_poc$analyte_mapping</code> and
<code>examplinib_poc$metabolite_mapping</code>. Both need to be
specified when the SDTM data set is created. See the documentation to
<code><a href="../reference/add_analyte_mapping.html">add_analyte_mapping()</a></code> and
<code><a href="../reference/add_metabolite_mapping.html">add_metabolite_mapping()</a></code> for details.</p>
<p>For this SDTM object, both have been added already.</p>
</div>
</div>
<div class="section level2">
<h2 id="create-the-nif-data-set">CREATE THE NIF DATA SET<a class="anchor" aria-label="anchor" href="#create-the-nif-data-set"></a>
</h2>
<p>Creation of the NIF data set for this study is straightforward. No
imputations are needed, and no study-specific fields are created:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_nif.html">make_nif</a></span><span class="op">(</span><span class="va">examplinib_poc</span>, spec<span class="op">=</span><span class="st">"PLASMA"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data cut-off was set to last observation time, 2001-04-27 14:31:00</span></span></code></pre></div>
<p>Of note, the LB domain within this SDTM object contains baseline
creatinine data which can be used to calculate the baseline creatinine
clearance as an estimate for glomerular filtration rate (eGFR). Please
see the below code for details.</p>
<p>In the first step, baseline creatinine is added from ‘LB’, and then
the creatinineclearance is calculated using further demographic
parameters (sex, age, race, weight). The standard method is
Cockcroft-Gault but other methods can be specified.</p>
<p>In the last step, the NIF data set, is cleaned up, keeping only the
fields that are commonly used:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_nif.html">make_nif</a></span><span class="op">(</span><span class="va">examplinib_poc</span>, spec<span class="op">=</span><span class="st">"PLASMA"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_bl_lab.html">add_bl_lab</a></span><span class="op">(</span><span class="va">examplinib_poc</span><span class="op">$</span><span class="va">domains</span><span class="op">[[</span><span class="st">"lb"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"CREAT"</span>, <span class="st">"SERUM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_bl_crcl.html">add_bl_crcl</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/compress_nif.html">compress_nif</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `compress_nif()` was deprecated in nif 0.40.1.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `compress()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Data cut-off was set to last observation time, 2001-04-27 14:31:00</span></span></code></pre></div>
<p>(In fact, the resulting NIF data set, including baseline creatinine
clearance is already included in the package under the name
‘examplinib_poc_nif’.)</p>
<p>In case NIF data sets have been generated independently, they can be
converted into NIF objects using <code><a href="../reference/new_nif.html">new_nif()</a></code>, see the
documentation to this function for details.</p>
<p>The resulting NIF object is essentially wrapper around a data frame
which has the set of variables expected by NONMEM or other population
analysis tools. This becomes visible when the object is converted into a
data frame:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#    REF    STUDYID ID           USUBJID NTIME TIME  TAD    ANALYTE AMT RATE</span></span>
<span><span class="co">#  1   1 2023000022  1 20230000221010001   0.0 0.00 0.00     RS2023 500    0</span></span>
<span><span class="co">#  2   2 2023000022  1 20230000221010001   0.0 0.00 0.00     RS2023   0    0</span></span>
<span><span class="co">#  3   3 2023000022  1 20230000221010001   0.0 0.00 0.00 RS2023487A   0    0</span></span>
<span><span class="co">#  4   4 2023000022  1 20230000221010001   1.5 1.75 1.75     RS2023   0    0</span></span>
<span><span class="co">#  5   5 2023000022  1 20230000221010001   1.5 1.75 1.75 RS2023487A   0    0</span></span>
<span><span class="co">#  6   6 2023000022  1 20230000221010001   4.0 4.40 4.40     RS2023   0    0</span></span>
<span><span class="co">#           DV        LNDV MDV CMT EVID DOSE AGE SEX  RACE HEIGHT WEIGHT      BMI</span></span>
<span><span class="co">#  1        NA          NA   1   1    1  500  84   0 WHITE  175.6     78 25.29563</span></span>
<span><span class="co">#  2 0.0000000        -Inf   0   2    0   NA  84   0 WHITE  175.6     78 25.29563</span></span>
<span><span class="co">#  3 0.0000000        -Inf   0   2    0   NA  84   0 WHITE  175.6     78 25.29563</span></span>
<span><span class="co">#  4 3.3677257  1.21423765   0   2    0  500  84   0 WHITE  175.6     78 25.29563</span></span>
<span><span class="co">#  5 3.8672063  1.35253235   0   2    0  500  84   0 WHITE  175.6     78 25.29563</span></span>
<span><span class="co">#  6 0.9731199 -0.02724796   0   2    0  500  84   0 WHITE  175.6     78 25.29563</span></span>
<span><span class="co">#     ACTARMCD PARENT METABOLITE TRTDY  BL_CRCL                 DTC</span></span>
<span><span class="co">#  1 TREATMENT RS2023      FALSE     1 57.37719 2001-01-17 08:24:00</span></span>
<span><span class="co">#  2 TREATMENT RS2023      FALSE     1 57.37719 2001-01-17 08:24:00</span></span>
<span><span class="co">#  3 TREATMENT RS2023       TRUE     1 57.37719 2001-01-17 08:24:00</span></span>
<span><span class="co">#  4 TREATMENT RS2023      FALSE     1 57.37719 2001-01-17 10:09:00</span></span>
<span><span class="co">#  5 TREATMENT RS2023       TRUE     1 57.37719 2001-01-17 10:09:00</span></span>
<span><span class="co">#  6 TREATMENT RS2023      FALSE     1 57.37719 2001-01-17 12:48:00</span></span></code></pre></div>
<p>When the NIF object itself is printed, a summary of the data is shown
instead:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span></span>
<span><span class="co">#  NONMEM input file (NIF) data set with data from 1 studies</span></span>
<span><span class="co">#  1344 observations from 80 subjects</span></span>
<span><span class="co">#  Males: 51, females: 29 (36.2%)</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Columns:</span></span>
<span><span class="co">#  REF, STUDYID, ID, USUBJID, NTIME, TIME, TAD, ANALYTE, AMT, RATE, DV, LNDV, MDV, CMT, EVID, DOSE, AGE, SEX, RACE, HEIGHT, WEIGHT, BMI, ACTARMCD, PARENT, METABOLITE, TRTDY, BL_CRCL, DTC </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  First rows of NIF data (selected columns):</span></span>
<span><span class="co">#  ID   NTIME   TIME    TAD    ANALYTE      AMT   DV                   CMT   EVID   DOSE   </span></span>
<span><span class="co">#  1    0       0       0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       0       0      RS2023       0     0                    2     0      NA     </span></span>
<span><span class="co">#  1    0       0       0      RS2023487A   0     0                    2     0      NA     </span></span>
<span><span class="co">#  1    1.5     1.75    1.75   RS2023       0     3.36772568843661     2     0      500    </span></span>
<span><span class="co">#  1    1.5     1.75    1.75   RS2023487A   0     3.86720626722762     2     0      500    </span></span>
<span><span class="co">#  1    4       4.4     4.4    RS2023       0     0.973119920231158    2     0      500    </span></span>
<span><span class="co">#  1    4       4.4     4.4    RS2023487A   0     9.56502537142429     2     0      500    </span></span>
<span><span class="co">#  1    0       24      0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       48      0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       72      0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       96      0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       120     0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       144     0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       168     0      RS2023       500   NA                   1     1      500    </span></span>
<span><span class="co">#  1    0       191.3   23.3   RS2023       0     0.0362596629478831   2     0      500</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploration">EXPLORATION<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<div class="section level3">
<h3 id="demographics">Demographics<a class="anchor" aria-label="anchor" href="#demographics"></a>
</h3>
<p>A good initial overview on the distribution of baseline parameters,
the administered drugs, analytes, observations, etc. can be inspected
with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. Since we have above added baseline eGFR to
the data set, the output also summarizes the number of patients with
normal renal function or impaired renal function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span></span>
<span><span class="co">#  NONMEM input file (NIF) data set summary</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Data from 80 subjects across 1 studies:</span></span>
<span><span class="co">#  STUDYID      N    </span></span>
<span><span class="co">#  2023000022   80   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Males: 51, females: 29 (36.2%)</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Renal function:</span></span>
<span><span class="co">#  CLASS      N    </span></span>
<span><span class="co">#  mild       37   </span></span>
<span><span class="co">#  moderate   15   </span></span>
<span><span class="co">#  normal     28   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Analytes:</span></span>
<span><span class="co">#  RS2023, RS2023487A</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  1344 observations:</span></span>
<span><span class="co">#  ANALYTE      N     </span></span>
<span><span class="co">#  RS2023       672   </span></span>
<span><span class="co">#  RS2023487A   672   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Administered drugs:</span></span>
<span><span class="co">#  RS2023</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Dose levels:</span></span>
<span><span class="co">#  RS2023   N    </span></span>
<span><span class="co">#  500      80   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Subjects with dose reductions</span></span>
<span><span class="co">#  RS2023   </span></span>
<span><span class="co">#  12       </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Treatment duration overview:</span></span>
<span><span class="co">#  PARENT   min   max   mean   median   </span></span>
<span><span class="co">#  RS2023   12    51    38     39</span></span></code></pre></div>
<p>For a visual overview of the NIF data set <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can be
applied to the summary:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-1.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-2.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-3.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-4.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-5.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-6.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-7.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-8.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-8-9.png" width="288"></p>
</div>
<div class="section level3">
<h3 id="exposure">Exposure<a class="anchor" aria-label="anchor" href="#exposure"></a>
</h3>
<p>In this study, all 80 subject received the same dose level:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dose_levels.html">dose_levels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Dose levels"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Dose levels</caption>
<thead><tr class="header">
<th align="right">RS2023</th>
<th align="right">N</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">500</td>
<td align="right">80</td>
</tr></tbody>
</table>
<p>However, there were subjects with dose reductions, as we can see when
filtering the NIF data set for EVID==1 (administrations) and summarizing
the administered dose:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">DOSE</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">250</td>
<td align="right">175</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">2866</td>
</tr>
</tbody>
</table>
<p>Note that in the above code, the nif dataset was first converted into
a data frame as the tidyverse verbs (‘filter’, ‘group_by’, ‘summarize’)
are not defined for NIF objects. This is a common pattern that will
often be used for more complex analyses!</p>
<p>To identify the subjects with dose reductions:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dose_red_sbs.html">dose_red_sbs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#   [1]  1 10 18 23 29 34 36 48 52 59 65 75</span></span></code></pre></div>
<p>Let’s have a plot of the doses over time in these subjects:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/dose_red_sbs.html">dose_red_sbs</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">TIME</span>, y<span class="op">=</span><span class="va">DOSE</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<p>We see that dose reductions happended at different times during
treatment. Another way of visualizing this is per the
<code><a href="../reference/mean_dose_plot.html">mean_dose_plot()</a></code> function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mean_dose_plot.html">mean_dose_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-13-1.png" width="480"></p>
<p>The upper panel shows the mean dose over time, and we can see that
after ~Day 13, the mean dose across all treated subjects drops due to
dose reductions in some subjects. To put this into context, the lower
panel shows the number of subjects on treatment over time, and we see
that most subjects had treatment durations of around 30 days. Note the
fluctuations that indicate single missed doses in individual
subjects!</p>
</div>
<div class="section level3">
<h3 id="pk-sampling">PK sampling<a class="anchor" aria-label="anchor" href="#pk-sampling"></a>
</h3>
<p>The PK sampling time points in this study were:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">NTIME</span>, <span class="va">ANALYTE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups<span class="op">=</span><span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from<span class="op">=</span><span class="st">"ANALYTE"</span>, values_from<span class="op">=</span><span class="st">"n"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Observations by time point and analyte"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Observations by time point and analyte</caption>
<thead><tr class="header">
<th align="right">NTIME</th>
<th align="right">RS2023</th>
<th align="right">RS2023487A</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">160</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">1.5</td>
<td align="right">160</td>
<td align="right">160</td>
</tr>
<tr class="odd">
<td align="right">2.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">3.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">160</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="right">6.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">8.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">10.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">12.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
</tbody>
</table>
<p>From the different numbers of samplings per nominal time point, we
see that only a subset of subjects had a rich sampling scheme. Let’s
identify those:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span>analyte<span class="op">=</span><span class="st">"RS2023"</span>, max_time<span class="op">=</span><span class="fl">24</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#   [1]  8  9 17 18 28 29 38 46 47 48 49 62</span></span></code></pre></div>
<p>In this code, the function <code><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs()</a></code> receives
as input the analyte of interest, the time interval across which the
number of sanmples is evaluated, and the minimum number of samples to
qualify the schedule as rich.</p>
</div>
<div class="section level3">
<h3 id="plasma-concentration-data">Plasma concentration data<a class="anchor" aria-label="anchor" href="#plasma-concentration-data"></a>
</h3>
<p>Let’s plot the individual and mean plasma concentration profiles on
Day 1 for the parent, RS2023, and the metabolite, RS2023487A:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                    <span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span>analyte<span class="op">=</span><span class="st">"RS2023"</span>, n<span class="op">=</span><span class="fl">4</span>, max_time<span class="op">=</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>points<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-16-1.png" width="480"></p>
<p>For the sampling on Day 1 only:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TIME</span><span class="op">&lt;=</span><span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>analyte<span class="op">=</span><span class="st">"RS2023"</span>, points<span class="op">=</span><span class="cn">T</span>, administrations<span class="op">=</span><span class="cn">T</span>, max_x<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-17-1.png" width="480"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>analyte<span class="op">=</span><span class="st">"RS2023"</span>, mean<span class="op">=</span><span class="cn">T</span>, y_scale<span class="op">=</span><span class="st">"log"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-17-2.png" width="480"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                    <span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span>analyte<span class="op">=</span><span class="st">"RS2023"</span>, n<span class="op">=</span><span class="fl">4</span>, max_time<span class="op">=</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>nominal_time<span class="op">=</span><span class="cn">F</span>, min_x<span class="op">=</span><span class="fl">192</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-17-3.png" width="480"></p>
<p>The above code showcases some options for the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function:</p>
<ul>
<li>In addition to the line graphs, the individual data points can be
shown with the option <code>points=TRUE</code>.</li>
<li>
<code>min_x</code> and <code>max_x</code> can be used to define a
speficic time interval.</li>
<li>In the first 2 graphs, the analyte (RS2023) is specifically
selected. In the third graph, no analyte is specified, and both analytes
are plotted.</li>
<li>
<code>nonminal_time=TRUE</code> selects the nominal time for the x
axis. The default for individual curves is
<code>nominal_time=FALSE</code>, i.e., the actual time is used. Note
that for mean profiles as shown in plot 2, nominal time is used
automatically for the averaging.</li>
<li>The option <code>y_scale="log"</code> can be used to plot the data
on a log concentration scale.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rainer Strotmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
