<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example: Multiple-dose study • nif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example: Multiple-dose study">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.57.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/nif-tutorial.html">Creating NIF files from SDTM data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-dose-example.html">Example: Multiple-dose study</a></li>
    <li><a class="dropdown-item" href="../articles/nif-imputations.html">Imputations and assumptions</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-study-example.html">Multiple studies in one NIF</a></li>
    <li><a class="dropdown-item" href="../articles/nif-formulas.html">NIF data definition using formulae</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstrotmann/nif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example: Multiple-dose study</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstrotmann/nif/blob/HEAD/vignettes/multiple-dose-example.Rmd" class="external-link"><code>vignettes/multiple-dose-example.Rmd</code></a></small>
      <div class="d-none name"><code>multiple-dose-example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstrotmann/nif" class="external-link">nif</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">OVERVIEW<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette walks through the creation of a NONMEM Input Format
(NIF) data set for a multiple dose study (study ‘RS2023-0022’), followed
by some basic exploratory analyses.</p>
<p>The fictional SDTM data for this study are included as part of the
NIF package (<code>examplinib_poc</code>). Custom SDTM data can be
loaded using <code><a href="../reference/read_sdtm.html">read_sdtm()</a></code>.</p>
<div class="section level3">
<h3 id="study-design">Study design<a class="anchor" aria-label="anchor" href="#study-design"></a>
</h3>
<p>Study ‘RS2023-0022’ is a single-arm study in which subjects received
multiple doses of ‘examplinib’ (substance code ‘RS2023’). The treatment
duration is different across subjects. PK sampling was on Days 1 and 8
of the treatment period. The PK sampling schedule was rich in the
initial subset of subjects and sparse in the others.</p>
</div>
<div class="section level3">
<h3 id="study-sdtm-data">Study SDTM data<a class="anchor" aria-label="anchor" href="#study-sdtm-data"></a>
</h3>
<p>The package provides the ‘sdtm’ class as a wrapper to keep all SDTM
domain tables of a clinical study together in one object. The
<code>examplinib_poc</code> sdtm object contains the DM, EX, PC and VS
domains. Let’s summarize the <code>examplinib_poc</code> sdtm object for
a high-level overview:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examplinib_poc</span><span class="op">)</span></span>
<span><span class="co">#&gt; -------- SDTM data set summary -------- </span></span>
<span><span class="co">#&gt; Study 2023000022 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data disposition</span></span>
<span><span class="co">#&gt;   DOMAIN   SUBJECTS   OBSERVATIONS   </span></span>
<span><span class="co">#&gt;   dm       103        103            </span></span>
<span><span class="co">#&gt;   vs       103        206            </span></span>
<span><span class="co">#&gt;   ex       80         468            </span></span>
<span><span class="co">#&gt;   pc       80         1344           </span></span>
<span><span class="co">#&gt;   lb       103        103            </span></span>
<span><span class="co">#&gt;   pp       13         432            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Arms (DM):</span></span>
<span><span class="co">#&gt;   ACTARMCD    ACTARM                 </span></span>
<span><span class="co">#&gt;   TREATMENT   Single Arm Treatment   </span></span>
<span><span class="co">#&gt;   SCRNFAIL    Screen Faillure        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatments (EX):</span></span>
<span><span class="co">#&gt;   EXAMPLINIB</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PK sample specimens (PC):</span></span>
<span><span class="co">#&gt;   PLASMA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PK analytes (PC):</span></span>
<span><span class="co">#&gt;   PCTEST       PCTESTCD     </span></span>
<span><span class="co">#&gt;   RS2023       RS2023       </span></span>
<span><span class="co">#&gt;   RS2023487A   RS2023487A</span></span></code></pre></div>
<p>Note that in the EX domain, the administered drug is given as
‘EXAMPLINIB’ while in PC, the corresponding analyte is ‘RS2023’. The
other analyte, ‘RS2023487A’ is a metabolite.</p>
</div>
</div>
<div class="section level2">
<h2 id="nif-data-set">NIF DATA SET<a class="anchor" aria-label="anchor" href="#nif-data-set"></a>
</h2>
<p>Following the tutorial given in
<code><a href="../articles/nif-tutorial.html">vignette("nif-tutorial")</a></code>, we start with a basic
pharmacokinetic nif object from <code>examplinic_poc</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sdtm</span> <span class="op">&lt;-</span> <span class="va">examplinib_poc</span></span>
<span></span>
<span><span class="va">nif_poc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_nif.html">new_nif</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_administration.html">add_administration</a></span><span class="op">(</span><span class="va">sdtm</span>, extrt <span class="op">=</span> <span class="st">"EXAMPLINIB"</span>, analyte <span class="op">=</span> <span class="st">"RS2023"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_observation.html">add_observation</a></span><span class="op">(</span><span class="va">sdtm</span>, domain <span class="op">=</span> <span class="st">"pc"</span>, testcd <span class="op">=</span> <span class="st">"RS2023"</span>, analyte <span class="op">=</span> <span class="st">"RS2023"</span>, cmt <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_observation.html">add_observation</a></span><span class="op">(</span><span class="va">sdtm</span>, domain <span class="op">=</span> <span class="st">"pc"</span>, testcd <span class="op">=</span> <span class="st">"RS2023487A"</span>, parent <span class="op">=</span> <span class="st">"RS2023"</span>, cmt <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></code></pre></div>
<p>Let’s add some further baseline data to our nif object. The serum
creatinine concentration can be used to calculate the individual
baseline creatinine clearance as an estimate for glomerular filtration
rate (eGFR).</p>
<p>We first add baseline creatinine from the ‘LB’ domain using the
generic <code><a href="../reference/add_baseline.html">add_baseline()</a></code> function. Then, creatinine clearance
is calculated using <code><a href="../reference/add_bl_crcl.html">add_bl_crcl()</a></code>. That function uses
further covariate data (sex, age, race and weight) and the
Cockcroft-Gault formula by default. For further options, see the
documentation for <code><a href="../reference/add_bl_crcl.html">add_bl_crcl()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op">&lt;-</span> <span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_baseline.html">add_baseline</a></span><span class="op">(</span><span class="va">sdtm</span>, domain <span class="op">=</span> <span class="st">"lb"</span>, testcd <span class="op">=</span> <span class="st">"CREAT"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_bl_crcl.html">add_bl_crcl</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; baseline_filter for BL_CREAT set to LBBLFL == 'Y'</span></span></code></pre></div>
<p>The nif data set now includes both baseline creatinine and baseline
creatinine clearance:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nif_poc</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#    REF ID    STUDYID           USUBJID AGE SEX  RACE HEIGHT WEIGHT      BMI</span></span>
<span><span class="co">#  1   1  1 2023000022 20230000221010001  58   1 WHITE  185.3   91.4 26.61922</span></span>
<span><span class="co">#  2   2  1 2023000022 20230000221010001  58   1 WHITE  185.3   91.4 26.61922</span></span>
<span><span class="co">#  3   3  1 2023000022 20230000221010001  58   1 WHITE  185.3   91.4 26.61922</span></span>
<span><span class="co">#                    DTC TIME NTIME TAFD TAD EVID AMT    ANALYTE CMT PARENT TRTDY</span></span>
<span><span class="co">#  1 2001-01-13 10:36:00    0     0    0   0    1 500     RS2023   1 RS2023     1</span></span>
<span><span class="co">#  2 2001-01-13 10:36:00    0     0    0   0    0   0     RS2023   2 RS2023     1</span></span>
<span><span class="co">#  3 2001-01-13 10:36:00    0     0    0   0    0   0 RS2023487A   3 RS2023     1</span></span>
<span><span class="co">#    METABOLITE DOSE MDV  ACTARMCD IMPUTATION DV BL_CREAT  BL_CRCL</span></span>
<span><span class="co">#  1      FALSE  500   1 TREATMENT            NA 72.78062 107.4689</span></span>
<span><span class="co">#  2      FALSE  500   0 TREATMENT             0 72.78062 107.4689</span></span>
<span><span class="co">#  3      FALSE  500   0 TREATMENT             0 72.78062 107.4689</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploration">EXPLORATION<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<div class="section level3">
<h3 id="demographics">Demographics<a class="anchor" aria-label="anchor" href="#demographics"></a>
</h3>
<p>For an initial overview on the distribution of baseline parameters in
the study population, the administered drugs, analytes, observations,
etc., nif objects can be inspected with the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function. After we have added baseline creatinine clearance, the output
also summarizes the number of patients with normal renal function or
impaired renal function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span></span>
<span><span class="co">#  ----- NONMEM Input Format (NIF) data summary -----</span></span>
<span><span class="co">#  Data from 80 subjects across one study:</span></span>
<span><span class="co">#    STUDYID      N    </span></span>
<span><span class="co">#    2023000022   80   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Sex distribution:</span></span>
<span><span class="co">#    SEX      N    percent   </span></span>
<span><span class="co">#    male     47   58.8      </span></span>
<span><span class="co">#    female   33   41.2      </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Renal impairment class:</span></span>
<span><span class="co">#    CLASS      N    percent   </span></span>
<span><span class="co">#    normal     31   38.8      </span></span>
<span><span class="co">#    mild       34   42.5      </span></span>
<span><span class="co">#    moderate   15   18.8      </span></span>
<span><span class="co">#    severe     0    0         </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Treatments:</span></span>
<span><span class="co">#    RS2023</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Analytes:</span></span>
<span><span class="co">#    RS2023, RS2023487A</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Subjects per dose level:</span></span>
<span><span class="co">#    RS2023   N    </span></span>
<span><span class="co">#    500      80   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  1344 observations:</span></span>
<span><span class="co">#    CMT   ANALYTE      N     </span></span>
<span><span class="co">#    2     RS2023       672   </span></span>
<span><span class="co">#    3     RS2023487A   672   </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Sampling schedule:</span></span>
<span><span class="co">#    NTIME   RS2023   RS2023487A   </span></span>
<span><span class="co">#    0       X        X            </span></span>
<span><span class="co">#    0.5     X        X            </span></span>
<span><span class="co">#    1       X        X            </span></span>
<span><span class="co">#    1.5     X        X            </span></span>
<span><span class="co">#    2       X        X            </span></span>
<span><span class="co">#    3       X        X            </span></span>
<span><span class="co">#    4       X        X            </span></span>
<span><span class="co">#    6       X        X            </span></span>
<span><span class="co">#    8       X        X            </span></span>
<span><span class="co">#    10      X        X            </span></span>
<span><span class="co">#    12      X        X            </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Subjects with dose reductions</span></span>
<span><span class="co">#    RS2023   </span></span>
<span><span class="co">#    25       </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Treatment duration overview:</span></span>
<span><span class="co">#    PARENT   min   max   mean   median   </span></span>
<span><span class="co">#    RS2023   56    99    78.5   79</span></span></code></pre></div>
<p>For a visual overview of the NIF data set <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can be
applied to the nif summary object. Ignore the
<code>invisible(capture.output())</code> construct in the below code.
Its purpose is to hide non-graphical output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-1.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-2.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-3.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-4.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-5.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-6.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-7.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-8.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-9.png" width="288"><img src="multiple-dose-example_files/figure-html/unnamed-chunk-7-10.png" width="288"></p>
</div>
<div class="section level3">
<h3 id="exposure">Exposure<a class="anchor" aria-label="anchor" href="#exposure"></a>
</h3>
<p>In this study, all 80 subject received the same dose level:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dose_levels.html">dose_levels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Dose levels"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Dose levels</caption>
<thead><tr class="header">
<th align="right">RS2023</th>
<th align="right">N</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">500</td>
<td align="right">80</td>
</tr></tbody>
</table>
<p>However, there were subjects with dose reductions, as we can see when
filtering the nif data set for <code>EVID == 1</code> (i.e.,
administrations) and summarizing the administered dose:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">DOSE</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">250</td>
<td align="right">916</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">5362</td>
</tr>
</tbody>
</table>
<p>To identify the subjects with dose reductions, we can use the
<code><a href="../reference/dose_red_sbs.html">dose_red_sbs()</a></code> function provided by the nif package:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dose_red_sbs.html">dose_red_sbs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 25 × 2</span></span></span>
<span><span class="co">#        ID USUBJID          </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span>    62 20230000221060015</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span>    66 20230000221070005</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span>    44 20230000221050006</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span>     3 20230000221010005</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span>    17 20230000221030004</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span>    76 20230000221070016</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span>    77 20230000221070018</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span>    10 20230000221020007</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span>    22 20230000221030010</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span>    46 20230000221050008</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre></div>
<p>Let’s have a plot of the doses over time in these subjects:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="fu"><a href="../reference/dose_red_sbs.html">dose_red_sbs</a></span><span class="op">(</span><span class="va">nif_poc</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">DOSE</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-11-1.png" width="480"></p>
<p>We see that dose reductions happened at different times during
treatment. Another way of visualizing this is per the
<code><a href="../reference/mean_dose_plot.html">mean_dose_plot()</a></code> function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/mean_dose_plot.html">mean_dose_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<p>The upper panel shows the mean dose over time, and we can see that
after ~Day 13, the mean dose across all treated subjects drops due to
dose reductions in some subjects. To put this into context, the lower
panel shows the number of subjects on treatment over time, and we see
that most subjects had treatment durations of around 30 days. Note the
fluctuations that indicate single missed doses in individual
subjects!</p>
</div>
<div class="section level3">
<h3 id="pk-sampling">PK sampling<a class="anchor" aria-label="anchor" href="#pk-sampling"></a>
</h3>
<p>The PK sampling time points in this study were:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">NTIME</span>, <span class="va">ANALYTE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"ANALYTE"</span>, values_from <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Observations by time point and analyte"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Observations by time point and analyte</caption>
<thead><tr class="header">
<th align="right">NTIME</th>
<th align="right">RS2023</th>
<th align="right">RS2023487A</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">160</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">1.5</td>
<td align="right">160</td>
<td align="right">160</td>
</tr>
<tr class="odd">
<td align="right">2.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">3.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">160</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="right">6.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">8.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">10.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">12.0</td>
<td align="right">24</td>
<td align="right">24</td>
</tr>
</tbody>
</table>
<p>From the different numbers of samplings per nominal time point, we
guess that only a subset of subjects had a rich sampling scheme. Let’s
identify those:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, max_time <span class="op">=</span> <span class="fl">24</span>, n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#   [1]  1  4  5 15 28 29 40 50 51 52 63 64</span></span></code></pre></div>
<p>For details, see the documentation to
<code><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="plasma-concentration-data">Plasma concentration data<a class="anchor" aria-label="anchor" href="#plasma-concentration-data"></a>
</h3>
<p>Let’s plot the individual and mean plasma concentration profiles on
Day 1 for the parent, RS2023, and the metabolite, RS2023487A:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">nif_poc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="fu"><a href="../reference/rich_sampling_sbs.html">rich_sampling_sbs</a></span><span class="op">(</span><span class="va">nif_poc</span>, analyte <span class="op">=</span> <span class="st">"RS2023"</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">500</span>, points <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Rich sampling subjects"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-15-1.png" width="480"></p>
<p>For single and multiple dose administrations separately:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/index_rich_sampling_intervals.html">index_rich_sampling_intervals</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RICH_N</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, mean <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Single-dose PK"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-16-1.png" width="480"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RICH_N</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, title <span class="op">=</span> <span class="st">"Multiple-dose PK"</span>, time <span class="op">=</span> <span class="st">"NTIME"</span>, mean <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-dose-example_files/figure-html/unnamed-chunk-16-2.png" width="480"></p>
<p>The above code made use of the helper function
<code><a href="../reference/index_rich_sampling_intervals.html">index_rich_sampling_intervals()</a></code> that identifies dosing
intervals with rich PK sampling. See the documentation for details.</p>
</div>
<div class="section level3">
<h3 id="non-compartmental-analysis">Non-compartmental analysis<a class="anchor" aria-label="anchor" href="#non-compartmental-analysis"></a>
</h3>
<p>The nif package includes functions for non-compartmental PK analysis.
Essentially, <code><a href="../reference/nca.html">nca()</a></code> is a wrapper around
<code><a href="https://rdrr.io/pkg/PKNCA/man/pk.nca.html" class="external-link">PKNCA::pk.nca()</a></code> from the popular <a href="https://cran.r-project.org/web/packages/PKNCA/index.html" class="external-link">PKNCA</a>
package.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nca</span> <span class="op">&lt;-</span> <span class="va">examplinib_poc_nif</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/index_rich_sampling_intervals.html">index_rich_sampling_intervals</a></span><span class="op">(</span>analyte <span class="op">=</span> <span class="st">"RS2023"</span>, min_n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/nca.html">nca</a></span><span class="op">(</span><span class="st">"RS2023"</span>, group <span class="op">=</span> <span class="st">"RICH_N"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/nca_summary_table.html">nca_summary_table</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"RICH_N"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="5%">
<col width="3%">
<col width="16%">
<col width="16%">
<col width="15%">
<col width="11%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="left">RICH_N</th>
<th align="right">DOSE</th>
<th align="right">n</th>
<th align="left">aucinf.obs</th>
<th align="left">auclast</th>
<th align="left">cmax</th>
<th align="left">half.life</th>
<th align="left">tmax</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">250</td>
<td align="right">4</td>
<td align="left">16962.71 (18)</td>
<td align="left">15764.51 (19)</td>
<td align="left">3050.03 (23)</td>
<td align="left">2.82 (10)</td>
<td align="left">2.37 (2; 2.67)</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">500</td>
<td align="right">12</td>
<td align="left">21147.25 (37)</td>
<td align="left">19382.1 (37)</td>
<td align="left">3530.09 (37)</td>
<td align="left">3 (14)</td>
<td align="left">2.53 (2; 2.78)</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">250</td>
<td align="right">4</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">3051.88 (24)</td>
<td align="left">2.85 (6)</td>
<td align="left">2.07 (1.7; 2.75)</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">500</td>
<td align="right">12</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">3559.39 (36)</td>
<td align="left">3.05 (12)</td>
<td align="left">2.51 (1.68; 3.03)</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rainer Strotmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
