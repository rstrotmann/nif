<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nif">
<title>Creating NIF files from SDTM data • nif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating NIF files from SDTM data">
<meta property="og:description" content="nif">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.40.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/multiple-dose-example.html">Example: NIF data for a multiple-dose study</a>
    <a class="dropdown-item" href="../articles/nif-imputations.html">Imputations and assumptions used by make_nif()</a>
    <a class="dropdown-item" href="../articles/nif-vignette.html">Creating NIF files from SDTM data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Creating NIF files from SDTM data</h1>
                        <h4 data-toc-skip class="author">Rainer
Strotmann</h4>
            
            <h4 data-toc-skip class="date">17-Sep-2023</h4>
      
      
      <div class="d-none name"><code>nif-vignette.Rmd</code></div>
    </div>

    
    
<p>This is a basic tutorial on using the <code>nif</code> package to
create NONMEM Input File (NIF) data sets from Study Data Tabulation
Model- (SDTM) formatted data.</p>
<p>The package is intended to facilitate providing the required data
table for population PK or PK/PD modeling. The source data are typically
contained in different SDTM tables and will be joined together, i.e.,
including but not limited to: baseline demographic and vital sign data,
drug exposure data, and pharmacokinetic concentrations.</p>
<p>In addition to re-arranging and joining the data, certain standard
data imputations are automatically performed by the functions provided
in this package, some of which are discussed in more detail in the
vignette “Imputations and assumptions used by make_nif()”.</p>
<p>This tutorial contains live code that depends on the following R
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">nif</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="import-sdtm-data">Import SDTM data<a class="anchor" aria-label="anchor" href="#import-sdtm-data"></a>
</h2>
<p>As a minimum, the following SDTM domains are expected to create a
basic NIF file:</p>
<ul>
<li>DM - demographic data, mostly age, sex and other variables per
subject</li>
<li>VS - vital signs, particularly weight and height at enrollment, per
subject</li>
<li>EX - exposure information for the administered drugs, e.g., the time
of administration, dose, etc.</li>
<li>PC - pharmacokinetic concentrations for the analytes associated with
the administered drugs</li>
</ul>
<p>In the most common use case, the respective SDTM data files, e.g., as
*.sas7bdat files, are copied into one folder (in the below example into
<code>path/to/sdtm/data</code>), and can then be loaded using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_sdtm_sas.html">read_sdtm_sas</a></span><span class="op">(</span><span class="st">"path/to/sdtm/data"</span><span class="op">)</span></span></code></pre></div>
<p>Based on the above, the minimum required SDTM files are
<code>dm.dat7bdat</code>, <code>vs.dat7bdat</code>,
<code>ex.dat7bdat</code> and <code>pc.dat7bdat</code>. However, if
additional covariates from AE, LB or any other SDTM domain are to be
added, an explicit list of the domains can be provided to the loading
function, e.g.,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_sdtm_sas.html">read_sdtm_sas</a></span><span class="op">(</span><span class="st">"path/to/sdtm/data"</span>, <span class="st">"dm"</span>, <span class="st">"vs"</span>, <span class="st">"ex"</span>, <span class="st">"pc"</span>, <span class="st">"lb"</span>, <span class="st">"ae"</span><span class="op">)</span></span></code></pre></div>
<p>The return value of the function is a <code>sdtm</code> object.</p>
</div>
<div class="section level2">
<h2 id="sdtm-objects">SDTM objects<a class="anchor" aria-label="anchor" href="#sdtm-objects"></a>
</h2>
<p><code>sdtm</code> objects are essentially lists of the SDTM domains
from a particular clinical study. The most common way of creating
<code>sdtm</code> objects is by importing the SDTM data using
<code><a href="../reference/read_sdtm_sas.html">read_sdtm_sas()</a></code> or <code><a href="../reference/read_sdtm_xpt.html">read_sdtm_xpt()</a></code> (see
above).</p>
<p>The original data can be retrieved accessing the individual domains
like demonstrated below for the (fictional) sample data set
<code>examplinib_fe</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplinib_fe</span><span class="op">$</span><span class="va">domains</span><span class="op">[[</span><span class="st">"dm"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SITEID  SUBJID         ACTARM ACTARMCD          RFICDTC          RFSTDTC</span></span>
<span><span class="co">#&gt; 1    105 1050001 Screen Failure SCRNFAIL 2000-12-20T11:04             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2    102 1020001 Screen Failure SCRNFAIL 2000-12-23T12:14             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3    104 1040001   Fed - Fasted       BA 2000-12-25T11:05 2001-01-06T11:05</span></span>
<span><span class="co">#&gt; 4    104 1040002   Fed - Fasted       BA 2000-12-29T09:55 2001-01-05T09:55</span></span>
<span><span class="co">#&gt; 5    104 1040003   Fed - Fasted       BA 2000-12-30T08:30 2001-01-10T08:30</span></span>
<span><span class="co">#&gt; 6    103 1030001   Fed - Fasted       BA 2000-12-31T09:08 2001-01-06T09:08</span></span>
<span><span class="co">#&gt;      STUDYID           USUBJID SEX AGE  AGEU COUNTRY DOMAIN            ARM</span></span>
<span><span class="co">#&gt; 1 2023000400 20230004001050001   M  34 YEARS     DEU     DM Screen Failure</span></span>
<span><span class="co">#&gt; 2 2023000400 20230004001020001   F  36 YEARS     DEU     DM Screen Failure</span></span>
<span><span class="co">#&gt; 3 2023000400 20230004001040001   M  32 YEARS     DEU     DM               </span></span>
<span><span class="co">#&gt; 4 2023000400 20230004001040002   M  41 YEARS     DEU     DM               </span></span>
<span><span class="co">#&gt; 5 2023000400 20230004001040003   M  19 YEARS     DEU     DM               </span></span>
<span><span class="co">#&gt; 6 2023000400 20230004001030001   F  32 YEARS     DEU     DM               </span></span>
<span><span class="co">#&gt;      ARMCD                      RACE ETHNIC          RFENDTC</span></span>
<span><span class="co">#&gt; 1 SCRNFAIL                     WHITE                    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2 SCRNFAIL                     WHITE                    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                              WHITE        2001-01-19T11:05</span></span>
<span><span class="co">#&gt; 4          BLACK OR AFRICAN AMERICAN        2001-01-18T09:55</span></span>
<span><span class="co">#&gt; 5                              WHITE        2001-01-23T08:30</span></span>
<span><span class="co">#&gt; 6                              WHITE        2001-01-19T09:08</span></span></code></pre></div>
<p>The most relevant domains, “dm”, “vs”, “ex” and “pc”, can also be
accessed directly, e.g.:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="va">examplinib_fe</span><span class="op">$</span><span class="va">dm</span></span></code></pre></div>
<p>Printing an <code>sdtm</code> object shows basic information on the
data set:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplinib_fe</span></span>
<span><span class="co">#&gt; SDTM data set summary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Study 2023000400 with 20 subjects providing PC data.</span></span>
<span><span class="co">#&gt; SDTM domains: dm, vs, ex, pc, lb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Arms:</span></span>
<span><span class="co">#&gt;   ACTARM         ACTARMCD</span></span>
<span><span class="co">#&gt; 1 Screen Failure SCRNFAIL</span></span>
<span><span class="co">#&gt; 2 Fed - Fasted   BA      </span></span>
<span><span class="co">#&gt; 3 Fasted - Fed   AB      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatments:</span></span>
<span><span class="co">#&gt;   EXTRT     </span></span>
<span><span class="co">#&gt; 1 EXAMPLINIB</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Specimens:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analytes:</span></span>
<span><span class="co">#&gt;   PCTEST     PCTESTCD  </span></span>
<span><span class="co">#&gt; 1 RS2023     RS2023    </span></span>
<span><span class="co">#&gt; 2 RS2023487A RS2023487A</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatment-to-analyte mappings:</span></span>
<span><span class="co">#&gt;   EXTRT      PCTESTCD</span></span>
<span><span class="co">#&gt; 1 EXAMPLINIB RS2023  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parent-to-metabolite mappings:</span></span>
<span><span class="co">#&gt; none</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Time mappings:</span></span>
<span><span class="co">#&gt; none</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="suggestions">Suggestions<a class="anchor" aria-label="anchor" href="#suggestions"></a>
</h2>
<p>Some fields in the original SDTM data are study specific, and is
therefore hard to fully automate the generation of standard NIF files
for downstream analysis steps. This needs study-specific considerations
and manual adaptations.</p>
<p>As a starting point the function <code><a href="../reference/suggest.html">suggest()</a></code> can provide
useful suggestions for a <code>sdtm</code>object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/suggest.html">suggest</a></span><span class="op">(</span><span class="va">examplinib_fe</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1. There are 3 arms defined in DM (see below).</span></span>
<span><span class="co">#&gt;    Consider defining a PART or ARM variable in the nif dataset, </span></span>
<span><span class="co">#&gt;    filtering for a particular arm, or defining a covariate based</span></span>
<span><span class="co">#&gt;    on ACTARMCD.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    ACTARM           ACTARMCD   </span></span>
<span><span class="co">#&gt;    Screen Failure   SCRNFAIL   </span></span>
<span><span class="co">#&gt;    Fed - Fasted     BA         </span></span>
<span><span class="co">#&gt;    Fasted - Fed     AB</span></span>
<span><span class="co">#&gt; 2. There are treatments (EXTRT) without analytes of the same name</span></span>
<span><span class="co">#&gt;    (see below).</span></span>
<span><span class="co">#&gt;    Consider adding a treatment-analyte mapping to the sdtm object</span></span>
<span><span class="co">#&gt;    See '?add_analyte_mapping' for additional information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    EXTRT        </span></span>
<span><span class="co">#&gt;    EXAMPLINIB   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Available analytes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    PCTESTCD     </span></span>
<span><span class="co">#&gt;    RS2023       </span></span>
<span><span class="co">#&gt;    RS2023487A</span></span></code></pre></div>
<p>In the case of <code>examplinib_fe</code>, there are different
treatment arms defined in the DM domain that should probably be included
as covariates in the NIF file (see suggestion 1). This will be
programmed once a basic NIF file has been generated (see below).</p>
<p>Also, the SDTM data do not provide a relation between treatments and
analytes (see suggestion 2). The parent drug name in the SDTM field
<code>EXTRT</code> (i.e., “EXAMPLINIB”) is different from the respective
analyte for the parent compound as specified in the field
<code>PCTESTCD</code> (i.e., “RS2023”). This is a common situation in
data from clinical studies. However, to correctly associate
pharmacokinetic concentrations with the administration of the
corresponding drug, a link needs to be provided between the treament and
the analyte. Similarly, metabolites (e.g., “RS2023487A”) need to be
linked to their parent compound - particularly if muliple drugs and
metabolites are included in the data set.</p>
<p>Both are described below.</p>
<div class="section level3">
<h3 id="analyte-mappings">Analyte mappings<a class="anchor" aria-label="anchor" href="#analyte-mappings"></a>
</h3>
<p>Often, the names for the treatments as listed in the
<code>EXTRT</code> field of EX do not directly correspond to the names
of the respective (parent) analytes codes used in the PC domain (i.e.,
in the <code>PCTESTCD</code> field).</p>
<p>To establish these relationships, treatment-analyte mappings must be
added to the <code>sdtm</code> object with
<code><a href="../reference/add_analyte_mapping.html">add_analyte_mapping()</a></code>. In this sample case, the analyte
“RS2023” refers to the (parent) plasma concentration for the drug
“EXAMPLINIB.”</p>
<p>To establish the relationships betwen metabolites and their parent
copounds, <code><a href="../reference/add_metabolite_mapping.html">add_metabolite_mapping()</a></code> can be used. In the
sample data, the <code>PCTESTCD</code> of “RS2023487A” represents a
metabolite of “RS2023”:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sdtm_expl</span> <span class="op">&lt;-</span> <span class="va">examplinib_fe</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_analyte_mapping.html">add_analyte_mapping</a></span><span class="op">(</span><span class="st">"EXAMPLINIB"</span>, <span class="st">"RS2023"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_metabolite_mapping.html">add_metabolite_mapping</a></span><span class="op">(</span><span class="st">"RS2023"</span>, <span class="st">"RS2023487A"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-nif-files">Creating NIF files<a class="anchor" aria-label="anchor" href="#creating-nif-files"></a>
</h2>
<p>The following section details how to create NIF files from an
<code>sdtm</code> object.</p>
<div class="section level3">
<h3 id="basic-nif-file">Basic NIF file<a class="anchor" aria-label="anchor" href="#basic-nif-file"></a>
</h3>
<p>Most steps in the generation of a basic NIF file from an
<code>sdtm</code> object are automated in the <code><a href="../reference/make_nif.html">make_nif()</a></code>
function. The resulting <code>nif</code> object is essentially a data
table that has individual rows for each administration and observation.
Following the NONMEM convention for oral administration, the
<code>EVID</code> field is “1” for the former, and “0” for the
latter.</p>
<p>Standard demographic information including SEX, AGE, RACE is taken
from the DM domain and merged into the data table. Baseline WEIGHT and
HEIGHT are taken from the VS domain.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_expl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_nif.html">make_nif</a></span><span class="op">(</span><span class="va">sdtm_expl</span><span class="op">)</span></span>
<span><span class="co">#&gt; No specimen specified. Set to PLASMA as the most likely.</span></span>
<span><span class="co">#&gt; Data cut-off was set to last observation time, 2001-03-12 10:13:00</span></span></code></pre></div>
<p>The output of the above code informs that there may be
pharmacokinetic data for multiple specimens in the PC domain, e.g.,
“PLASMA” and “URINE” or “FECES”. As no specimem was defined,
<code><a href="../reference/make_nif.html">make_nif()</a></code> takes the most likely (“PLASMA”). Alternatively,
the specimen of interest can be explicitly provided (see
<code>?make_nif()</code> for details).</p>
<p>Also, a data cut-off was applied that reflects the date and time of
the last observation. This may be most relevant in multiple-dose studies
where further administrations may be recorded after the last
oberservation. These administration events are excluded from the NIF
file.</p>
</div>
<div class="section level3">
<h3 id="study-specific-covariates">Study-specific covariates<a class="anchor" aria-label="anchor" href="#study-specific-covariates"></a>
</h3>
<p>In many clinical studies, participants are treated in subgroups,
e.g., dose groups, formulations, co-administered drug interaction
perpetrators. While dose is automatically included as a continuous
covariate per the EX domain, other categorical covariates may need to be
derived, e.g., from the study arm field.</p>
<p>The inclcuded sample study is a food effect study in which
participants received the test drug, EXAMPLINIB, fasted or fed in a
randomized sequence (see <code>ACTARM</code> and <code>ACTARMCD</code>
in the output of <code><a href="../reference/suggest.html">suggest()</a></code> above). Often, relevant fields
for consideration are <code>EPOCH</code> and <code>ACTARMCD</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_expl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">EPOCH</span>, <span class="va">ACTARMCD</span>, <span class="va">ACTARM</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    EPOCH ACTARMCD       ACTARM</span></span>
<span><span class="co">#&gt; 1 OPEN LABEL TREATMENT 1       BA Fed - Fasted</span></span>
<span><span class="co">#&gt; 2 OPEN LABEL TREATMENT 2       BA Fed - Fasted</span></span>
<span><span class="co">#&gt; 3 OPEN LABEL TREATMENT 1       AB Fasted - Fed</span></span>
<span><span class="co">#&gt; 4 OPEN LABEL TREATMENT 2       AB Fasted - Fed</span></span></code></pre></div>
<p>To create a <code>FASTED</code> covariate for the sample data set,
first the period number is derived from the <code>EPOCH</code> field,
and then the current <code>ACTARM</code> in that treatment period is
decoded to <code>FASTED</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_expl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_nif.html">make_nif</a></span><span class="op">(</span><span class="va">sdtm_expl</span>, silent<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PERIOD<span class="op">=</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">EPOCH</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TREATMENT<span class="op">=</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">ACTARMCD</span>, <span class="va">PERIOD</span>, <span class="va">PERIOD</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>FASTED<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">TREATMENT</span><span class="op">==</span><span class="st">"A"</span> <span class="op">~</span> <span class="fl">1</span>, .default<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note the <code>silent=T</code> modifier that omits all messages from
<code><a href="../reference/make_nif.html">make_nif()</a></code>.</p>
<p>The NIF file has now the additional fields <code>PERIOD</code>,
<code>TREATMENT</code> and <code>FASTED</code>, see the first few lines
of the the data:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nif_expl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PERIOD</span>, <span class="va">TREATMENT</span>, <span class="va">FASTED</span>, <span class="va">TIME</span>, <span class="va">EVID</span>, <span class="va">AMT</span>, <span class="va">ANALYTE</span>, <span class="va">DV</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PERIOD</span>, <span class="va">TREATMENT</span>, <span class="va">FASTED</span>, <span class="va">TIME</span>, <span class="va">EVID</span>, <span class="va">ANALYTE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="23%">
<col width="9%">
<col width="12%">
<col width="9%">
<col width="6%">
<col width="6%">
<col width="5%">
<col width="14%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">USUBJID</th>
<th align="left">PERIOD</th>
<th align="left">TREATMENT</th>
<th align="right">FASTED</th>
<th align="right">TIME</th>
<th align="right">EVID</th>
<th align="right">AMT</th>
<th align="left">ANALYTE</th>
<th align="right">DV</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">20230004001010001</td>
<td align="left">1</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">RS2023</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">20230004001010001</td>
<td align="left">1</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">RS2023487A</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">20230004001010001</td>
<td align="left">1</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">500</td>
<td align="left">RS2023</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">20230004001010001</td>
<td align="left">1</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">0.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">RS2023</td>
<td align="right">0.9025036</td>
</tr>
<tr class="odd">
<td align="left">20230004001010001</td>
<td align="left">1</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">0.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">RS2023487A</td>
<td align="right">0.3859740</td>
</tr>
<tr class="even">
<td align="left">20230004001010001</td>
<td align="left">1</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">1.0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">RS2023</td>
<td align="right">1.6201458</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="graphical-exploration">Graphical exploration<a class="anchor" aria-label="anchor" href="#graphical-exploration"></a>
</h2>
<p>NIF objects allow basic ploting functionality using
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, directly applied to the object. The below shows
some examples for common exploratory tasks (for more detail, refer to
<code>?plot.nif()</code>).</p>
<p>Obviously, more complex custom plots (or other analyses) can be done
manually on the <code>nif</code> data. Note that the <code>nif</code>
object must be converted to a data frame for this purpose (i.e., using
<code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code>):</p>
<p>In the simplest exploratory plot, all analytes are shown:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nif_expl</span><span class="op">)</span></span></code></pre></div>
<p><img src="nif-vignette_files/figure-html/unnamed-chunk-13-1.png" width="384"></p>
<p>Modifiers to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function allow common
adjustments. To show, e.g., the food effect on the parent compound,
“RS2023” in individual subjects, limiting the time axis to 24 h and
showing the nominal time instead of the actual time:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nif_expl</span>, analyte<span class="op">=</span><span class="st">"RS2023"</span>, group<span class="op">=</span><span class="st">"FASTED"</span>, max_x<span class="op">=</span><span class="fl">24</span>, mean<span class="op">=</span><span class="cn">F</span>, points<span class="op">=</span><span class="cn">T</span>, nominal_time<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="nif-vignette_files/figure-html/unnamed-chunk-14-1.png" width="384"></p>
<p>The following shows the mean plasma concentration profiles over 24 h
by food status:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nif_expl</span>, analyte<span class="op">=</span><span class="st">"RS2023"</span>, group<span class="op">=</span><span class="st">"FASTED"</span>, max_x<span class="op">=</span><span class="fl">24</span>, mean<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="nif-vignette_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<p>There are further display options, refer to <code>?plot.nif()</code>
for details.</p>
<p>For a quick overview, use <code><a href="../reference/nif_viewer.html">nif_viewer()</a></code> to show
individual subjects interactively:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nif_viewer.html">nif_viewer</a></span><span class="op">(</span><span class="va">nif_expl</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rainer Strotmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
