<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Append observation events — add_observation • nif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Append observation events — add_observation"><meta name="description" content="Observations can be pharmacokinetic observations (i.e., from the PC domain),
or any other class of observation from any other SDTM domain. The 'testcd'
specifies the value of the respective TESTCD field (e.g., 'PCTESTCD',
'VSTESTCD' or 'LBTESTCD') that defines the observation. Observation events
can be attached to an administered drug by specifying the 'parent' field.
This is required for, e.g., the time-after-dose ('TAD') and
time-after-first-dose ('TAFD') time calculation."><meta property="og:description" content="Observations can be pharmacokinetic observations (i.e., from the PC domain),
or any other class of observation from any other SDTM domain. The 'testcd'
specifies the value of the respective TESTCD field (e.g., 'PCTESTCD',
'VSTESTCD' or 'LBTESTCD') that defines the observation. Observation events
can be attached to an administered drug by specifying the 'parent' field.
This is required for, e.g., the time-after-dose ('TAD') and
time-after-first-dose ('TAFD') time calculation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.56.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/creating-multiple-study-nif.html">creating-multiple-study-nif</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-dose-example.html">NIF data for a multiple-dose study</a></li>
    <li><a class="dropdown-item" href="../articles/nif-imputations.html">Imputations and assumptions</a></li>
    <li><a class="dropdown-item" href="../articles/nif-vignette.html">Creating NIF files from SDTM data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstrotmann/nif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Append observation events</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstrotmann/nif/blob/HEAD/R/nif_observations.R" class="external-link"><code>R/nif_observations.R</code></a></small>
      <div class="d-none name"><code>add_observation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Observations can be pharmacokinetic observations (i.e., from the PC domain),
or any other class of observation from any other SDTM domain. The 'testcd'
specifies the value of the respective <strong>TESTCD</strong> field (e.g., 'PCTESTCD',
'VSTESTCD' or 'LBTESTCD') that defines the observation. Observation events
can be attached to an administered drug by specifying the 'parent' field.
This is required for, e.g., the time-after-dose ('TAD') and
time-after-first-dose ('TAFD') time calculation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_observation</span><span class="op">(</span></span>
<span>  <span class="va">nif</span>,</span>
<span>  <span class="va">sdtm</span>,</span>
<span>  <span class="va">domain</span>,</span>
<span>  <span class="va">testcd</span>,</span>
<span>  analyte <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metabolite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cmt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subject_filter <span class="op">=</span> <span class="st">"!ACTARMCD %in% c('SCRNFAIL', 'NOTTRT')"</span>,</span>
<span>  observation_filter <span class="op">=</span> <span class="st">"TRUE"</span>,</span>
<span>  cat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TESTCD_field <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  DTC_field <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  DV_field <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coding_table <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  NTIME_lookup <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ntime_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_day_in_ntime <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  duplicates <span class="op">=</span> <span class="st">"stop"</span>,</span>
<span>  duplicate_function <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  omit_not_done <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nif">nif<a class="anchor" aria-label="anchor" href="#arg-nif"></a></dt>
<dd><p>A nif object.</p></dd>


<dt id="arg-sdtm">sdtm<a class="anchor" aria-label="anchor" href="#arg-sdtm"></a></dt>
<dd><p>A sdtm object. Needs at least the 'DM' and 'VS' domains, and the
domain the observations come from.</p></dd>


<dt id="arg-domain">domain<a class="anchor" aria-label="anchor" href="#arg-domain"></a></dt>
<dd><p>The domain as character.</p></dd>


<dt id="arg-testcd">testcd<a class="anchor" aria-label="anchor" href="#arg-testcd"></a></dt>
<dd><p>The observation variable, as character.</p></dd>


<dt id="arg-analyte">analyte<a class="anchor" aria-label="anchor" href="#arg-analyte"></a></dt>
<dd><p>The name for the analyte. Defaults to the 'testcd', if NULL.</p></dd>


<dt id="arg-parent">parent<a class="anchor" aria-label="anchor" href="#arg-parent"></a></dt>
<dd><p>The name of the parent analyte for the observation as
character. Defaults to the value of 'analyte' if NULL.</p></dd>


<dt id="arg-metabolite">metabolite<a class="anchor" aria-label="anchor" href="#arg-metabolite"></a></dt>
<dd><p>Observation is a metabolite, as logical.</p></dd>


<dt id="arg-cmt">cmt<a class="anchor" aria-label="anchor" href="#arg-cmt"></a></dt>
<dd><p>The compartment for the observation as numeric.</p></dd>


<dt id="arg-subject-filter">subject_filter<a class="anchor" aria-label="anchor" href="#arg-subject-filter"></a></dt>
<dd><p>The filtering to apply to the DM domain.</p></dd>


<dt id="arg-observation-filter">observation_filter<a class="anchor" aria-label="anchor" href="#arg-observation-filter"></a></dt>
<dd><p>The filtering to apply to the observation source
data.</p></dd>


<dt id="arg-cat">cat<a class="anchor" aria-label="anchor" href="#arg-cat"></a></dt>
<dd><p>xxCAT filter to apply, as character.</p></dd>


<dt id="arg-scat">scat<a class="anchor" aria-label="anchor" href="#arg-scat"></a></dt>
<dd><p>xxSCAT filter to apply, as character.</p></dd>


<dt id="arg-testcd-field">TESTCD_field<a class="anchor" aria-label="anchor" href="#arg-testcd-field"></a></dt>
<dd><p>The xxTESTCD field. Defaults to the two-character domain
name followed by 'TESTCD', if NULL.</p></dd>


<dt id="arg-dtc-field">DTC_field<a class="anchor" aria-label="anchor" href="#arg-dtc-field"></a></dt>
<dd><p>The field to use as the date-time code for the observation.
Defaults to the two-character domain name followed by 'DTC', if NULL.</p></dd>


<dt id="arg-dv-field">DV_field<a class="anchor" aria-label="anchor" href="#arg-dv-field"></a></dt>
<dd><p>the field to use as the dependent variable. Defaults to the
two-character domain name followed by 'STRESN', if NULL.</p></dd>


<dt id="arg-coding-table">coding_table<a class="anchor" aria-label="anchor" href="#arg-coding-table"></a></dt>
<dd><p>Coding table to translate a categorical values into
numerical values, as data frame. The data frame must have at least one
column that matches a column in the domain, and a numerical 'DV' column
that provides the recoding result.</p></dd>


<dt id="arg-factor">factor<a class="anchor" aria-label="anchor" href="#arg-factor"></a></dt>
<dd><p>Multiplier for the DV field, as numeric.</p></dd>


<dt id="arg-ntime-lookup">NTIME_lookup<a class="anchor" aria-label="anchor" href="#arg-ntime-lookup"></a></dt>
<dd><p>A data frame with two columns, a column that defines the
custom nominal time information in the target domain (e.g., 'PCELTM'), and
'NTIME'. This data frame is left_joined into the observation data frame
to provide the NTIME field.</p></dd>


<dt id="arg-ntime-method">ntime_method<a class="anchor" aria-label="anchor" href="#arg-ntime-method"></a></dt>
<dd><p>the field to derive the nominal time from. Allowed values
are "TPT" and "ELTM".Defaults to xxTPT where xx is the domain name, if NULL.</p></dd>


<dt id="arg-keep">keep<a class="anchor" aria-label="anchor" href="#arg-keep"></a></dt>
<dd><p>Columns to keep, as character.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>Include debug fields, as logical.</p></dd>


<dt id="arg-include-day-in-ntime">include_day_in_ntime<a class="anchor" aria-label="anchor" href="#arg-include-day-in-ntime"></a></dt>
<dd><p>as logical.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Suppress messages, as logical. Defaults to nif_option setting
if NULL.</p></dd>


<dt id="arg-duplicates">duplicates<a class="anchor" aria-label="anchor" href="#arg-duplicates"></a></dt>
<dd><p>Selection how to deal with duplicate observations with
respect to the USUBJID, ANALYTE and DTC fields:</p><ul><li><p>'stop': Stop execution and produce error message</p></li>
<li><p>'ignore': Include duplicates in the data set</p></li>
<li><p>'identify': Return a list of duplicate entries</p></li>
<li><p>'resolve': Resolve duplicates, applying the <code>duplicate_function</code> to the
duplicate entries.</p></li>
</ul></dd>


<dt id="arg-duplicate-function">duplicate_function<a class="anchor" aria-label="anchor" href="#arg-duplicate-function"></a></dt>
<dd><p>Function to resolve duplicate values, defaults to
<code>mean</code>.</p></dd>


<dt id="arg-omit-not-done">omit_not_done<a class="anchor" aria-label="anchor" href="#arg-omit-not-done"></a></dt>
<dd><p>Delete rows where xxSTAT is "NOT DONE, as logical.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical indicating whether to remove NA values when applying the
duplicate_function. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A nif object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Observations can be further specified with the 'observation_filter' term. The
filter term can refer to any field of the respective SDTM domain.</p>
<p>A PK/PD model compartment can be specified with 'cmt' or will be
automatically assigned if <code>cmt = NULL</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="add_administration.html">add_administration()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rainer Strotmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

